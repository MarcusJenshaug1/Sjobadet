import{c as L,u as w,a as p,n as E,j as e,o as B,p as _,M as z,U as O,B as m,t as g}from"./iframe-BeGkvnHr.js";import{s}from"./SaunaCard.module-ChdoFVbf.js";import{B as C}from"./Badge-gq3LtFzO.js";import{B as I}from"./BookingModal-BbSyfe_L.js";import{g as U,f as M}from"./availability-utils-DC47xJm5.js";import{E as T}from"./external-link-mrAcOcOW.js";const R=[["path",{d:"M4.929 4.929 19.07 19.071",key:"196cmz"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],A=L("ban",R);const W=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],x=L("clock",W);function q({sauna:t,isMaintenanceMode:v=!1}){const r=w(),f=p.useRef(null),o=p.useRef(!1),[b,h]=p.useState(null),l=`/home/${t.slug}`;p.useEffect(()=>{if(o.current)return;const i=f.current;if(!i)return;const c=new IntersectionObserver(d=>{d.forEach(D=>{if(D.isIntersecting&&!o.current){try{r.prefetch(l)}catch{}o.current=!0,c.disconnect()}})},{rootMargin:"150px"});return c.observe(i),()=>c.disconnect()},[r,l]);const $=()=>{if(!o.current){try{r.prefetch(l),g("sauna_card_prefetch",{saunaId:t.id,saunaName:t.name})}catch{}o.current=!0}},k=()=>{r.push(l)},P=i=>{(i.key==="Enter"||i.key===" ")&&(i.preventDefault(),k())},a=(()=>{if(!t.nextAvailableSlot)return null;const{time:i,availableSpots:c,date:d}=t.nextAvailableSlot,S=U(d,new Date)==="i dag"?null:M(d);return{time:i,availableSpots:c,dayLabel:S?`(${S})`:null}})(),N=t.driftStatus==="closed",n=E(t.openingHourOverrides,new Date,"Europe/Oslo"),j=n?n.active===!1?"Stengt i dag (avvik)":n.opens&&n.closes?`Avvik i dag: ${n.opens}–${n.closes}`:"Avvikende åpningstid i dag":null,u=(()=>{if(N)return"NONE";const i=t.nextAvailableSlot?.availableSpots;if(i==null)return"PLENTY";if(i<=0)return"NONE";if(t.capacityDropin){if(i/t.capacityDropin<=.3)return"LOW"}else if(i<=2)return"LOW";return"PLENTY"})(),y=u==="NONE"?s.chipNone:u==="LOW"?s.chipFew:s.chipPlenty;return e.jsxs("div",{className:s.card,ref:f,onMouseEnter:$,role:"link",tabIndex:0,"aria-label":`Badstue: ${t.name}`,onClick:k,onKeyDown:P,children:[e.jsxs("div",{className:s.imageContainer,children:[t.imageUrl?e.jsx(B,{src:t.imageUrl,alt:`${t.name} - badstue`,fill:!0,className:s.image,sizes:"(max-width: 640px) 100vw, (max-width: 1024px) 50vw, 400px",loading:"lazy",quality:75,decoding:"async"}):e.jsx("div",{style:{width:"100%",height:"100%",backgroundColor:"#f1f5f9",display:"flex",alignItems:"center",justifyContent:"center",color:"#94a3b8"},role:"img","aria-label":"Bilde ikke tilgjengelig",children:e.jsx("span",{children:"Bilde kommer"})}),e.jsx("div",{className:s.imageGradient}),N?e.jsxs(C,{className:s.badge,variant:"danger",size:"sm",children:[e.jsx(A,{size:14}),"Stengt"]}):u==="LOW"?e.jsxs(C,{className:s.badge,variant:"warning",size:"sm",children:[e.jsx(_,{size:14}),"Få plasser"]}):null]}),e.jsxs("div",{className:s.content,children:[e.jsxs("div",{className:s.header,children:[e.jsx("h3",{className:s.name,children:t.name}),e.jsxs("div",{className:s.locationContainer,children:[e.jsx(z,{size:16}),t.location]})]}),j&&e.jsxs("div",{className:s.overrideNote,onClick:i=>i.stopPropagation(),children:[e.jsx(x,{size:16}),e.jsx("span",{children:j})]}),!v&&e.jsxs("div",{className:s.chipsContainer,onClick:i=>i.stopPropagation(),children:[a?e.jsxs("div",{className:`${s.chip} ${y}`,children:[e.jsx(x,{size:16}),e.jsxs("span",{children:["Neste ledige: ",a.time,a.dayLabel?` ${a.dayLabel}`:""]})]}):e.jsxs("div",{className:`${s.chip} ${s.chipNone}`,children:[e.jsx(x,{size:16}),e.jsx("span",{children:"Ingen ledige timer nå"})]}),a&&e.jsxs("div",{className:`${s.chip} ${y}`,children:[e.jsx(O,{size:16}),e.jsxs("span",{children:[a.availableSpots,"/",t.capacityDropin||10," ledige"]})]})]}),e.jsxs("div",{className:s.description,children:[t.shortDescription,e.jsx("span",{className:s.lesMer,children:"Les mer"})]}),e.jsxs("div",{className:s.actions,children:[e.jsxs("div",{className:s.bookingGrid,children:[t.bookingUrlDropin?e.jsx(m,{href:t.bookingUrlDropin||"#",onClick:i=>{i.preventDefault(),i.stopPropagation(),h(t.bookingUrlDropin||null),g("booking_click",{type:"drop-in",saunaId:t.id,saunaName:t.name})},className:s.btnDropin,children:"Book Drop-in"}):e.jsx(m,{disabled:!0,className:`${s.btnDropin} ${s.btnDisabled}`,children:"Kun privat"}),t.bookingUrlPrivat?e.jsx(m,{href:t.bookingUrlPrivat||"#",onClick:i=>{i.preventDefault(),i.stopPropagation(),h(t.bookingUrlPrivat||null),g("booking_click",{type:"private",saunaId:t.id,saunaName:t.name})},className:s.btnPrivat,children:"Book Privat"}):e.jsx(m,{disabled:!0,className:`${s.btnPrivat} ${s.btnDisabled}`,children:"Ikke tilgj."})]}),!v&&e.jsxs("button",{className:s.btnDetails,onClick:i=>{i.preventDefault(),i.stopPropagation(),g("view_sauna_detail",{saunaId:t.id,saunaName:t.name}),r.push(l)},children:["Se badstuen",e.jsx(T,{size:16})]})]})]}),e.jsx("div",{onClick:i=>i.stopPropagation(),children:e.jsx(I,{open:!!b,url:b||"",onClose:()=>h(null),title:`${t.name} booking`})})]})}q.__docgenInfo={description:"",methods:[],displayName:"SaunaCard",props:{sauna:{required:!0,tsType:{name:"SaunaProps"},description:""},isMaintenanceMode:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}}}};export{q as S};
