import{j as e}from"./jsx-runtime-DDl-KI2x.js";import{b as d}from"./iframe-C_JdCeVj.js";import{n as $}from"./image-BVT29y58.js";import{s as i}from"./SaunaCard.module-BT2yqB1K.js";import{B as m}from"./Button-Beo3o9mi.js";import{B as y}from"./Badge-s7y48ZH4.js";import{t as p}from"./tracking-CB1Ze4Aw.js";import{u as P}from"./optional-router-Brsul3qR.js";import{B as w}from"./BookingModal-f4v_DzpU.js";import{g as B,f as E}from"./availability-utils-DC47xJm5.js";import{c as S}from"./createLucideIcon-DMVqFKYz.js";import{T as _}from"./triangle-alert-DewAN8h2.js";import{M as z}from"./map-pin-O-PiCWul.js";import{U as I}from"./users-BwxUpH-y.js";import{E as U}from"./external-link-CM5_4Tjb.js";const O=[["path",{d:"M4.929 4.929 19.07 19.071",key:"196cmz"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],T=S("ban",O);const M=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],D=S("clock",M);function R({sauna:t,isMaintenanceMode:u=!1}){const a=P(),x=d.useRef(null),n=d.useRef(!1),[g,f]=d.useState(null),o=`/home/${t.slug}`;d.useEffect(()=>{if(n.current)return;const s=x.current;if(!s)return;const l=new IntersectionObserver(c=>{c.forEach(j=>{if(j.isIntersecting&&!n.current){try{a.prefetch(o)}catch{}n.current=!0,l.disconnect()}})},{rootMargin:"150px"});return l.observe(s),()=>l.disconnect()},[a,o]);const C=()=>{if(!n.current){try{a.prefetch(o),p("sauna_card_prefetch",{saunaId:t.id,saunaName:t.name})}catch{}n.current=!0}},b=()=>{a.push(o)},L=s=>{(s.key==="Enter"||s.key===" ")&&(s.preventDefault(),b())},r=(()=>{if(!t.nextAvailableSlot)return null;const{time:s,availableSpots:l,date:c}=t.nextAvailableSlot,k=B(c,new Date)==="i dag"?null:E(c);return{time:s,availableSpots:l,dayLabel:k?`(${k})`:null}})(),v=t.driftStatus==="closed",h=(()=>{if(v)return"NONE";const s=t.nextAvailableSlot?.availableSpots;if(s==null)return"PLENTY";if(s<=0)return"NONE";if(t.capacityDropin){if(s/t.capacityDropin<=.3)return"LOW"}else if(s<=2)return"LOW";return"PLENTY"})(),N=h==="NONE"?i.chipNone:h==="LOW"?i.chipFew:i.chipPlenty;return e.jsxs("div",{className:i.card,ref:x,onMouseEnter:C,role:"link",tabIndex:0,"aria-label":`Badstue: ${t.name}`,onClick:b,onKeyDown:L,children:[e.jsxs("div",{className:i.imageContainer,children:[t.imageUrl?e.jsx($,{src:t.imageUrl,alt:`${t.name} - badstue`,fill:!0,className:i.image,sizes:"(max-width: 640px) 100vw, (max-width: 1024px) 50vw, 400px",loading:"lazy",quality:75,decoding:"async"}):e.jsx("div",{style:{width:"100%",height:"100%",backgroundColor:"#f1f5f9",display:"flex",alignItems:"center",justifyContent:"center",color:"#94a3b8"},role:"img","aria-label":"Bilde ikke tilgjengelig",children:e.jsx("span",{children:"Bilde kommer"})}),e.jsx("div",{className:i.imageGradient}),v?e.jsxs(y,{className:i.badge,variant:"danger",size:"sm",children:[e.jsx(T,{size:14}),"Stengt"]}):h==="LOW"?e.jsxs(y,{className:i.badge,variant:"warning",size:"sm",children:[e.jsx(_,{size:14}),"Få plasser"]}):null]}),e.jsxs("div",{className:i.content,children:[e.jsxs("div",{className:i.header,children:[e.jsx("h3",{className:i.name,children:t.name}),e.jsxs("div",{className:i.locationContainer,children:[e.jsx(z,{size:16}),t.location]})]}),!u&&e.jsxs("div",{className:i.chipsContainer,onClick:s=>s.stopPropagation(),children:[r?e.jsxs("div",{className:`${i.chip} ${N}`,children:[e.jsx(D,{size:16}),e.jsxs("span",{children:["Neste ledige: ",r.time,r.dayLabel?` ${r.dayLabel}`:""]})]}):e.jsxs("div",{className:`${i.chip} ${i.chipNone}`,children:[e.jsx(D,{size:16}),e.jsx("span",{children:"Ingen ledige timer nå"})]}),r&&e.jsxs("div",{className:`${i.chip} ${N}`,children:[e.jsx(I,{size:16}),e.jsxs("span",{children:[r.availableSpots,"/",t.capacityDropin||10," ledige"]})]})]}),e.jsxs("div",{className:i.description,children:[t.shortDescription,e.jsx("span",{className:i.lesMer,children:"Les mer"})]}),e.jsxs("div",{className:i.actions,children:[e.jsxs("div",{className:i.bookingGrid,children:[t.bookingUrlDropin?e.jsx(m,{href:t.bookingUrlDropin||"#",onClick:s=>{s.preventDefault(),s.stopPropagation(),f(t.bookingUrlDropin||null),p("booking_click",{type:"drop-in",saunaId:t.id,saunaName:t.name})},className:i.btnDropin,children:"Book Drop-in"}):e.jsx(m,{disabled:!0,className:`${i.btnDropin} ${i.btnDisabled}`,children:"Kun privat"}),t.bookingUrlPrivat?e.jsx(m,{href:t.bookingUrlPrivat||"#",onClick:s=>{s.preventDefault(),s.stopPropagation(),f(t.bookingUrlPrivat||null),p("booking_click",{type:"private",saunaId:t.id,saunaName:t.name})},className:i.btnPrivat,children:"Book Privat"}):e.jsx(m,{disabled:!0,className:`${i.btnPrivat} ${i.btnDisabled}`,children:"Ikke tilgj."})]}),!u&&e.jsxs("button",{className:i.btnDetails,onClick:s=>{s.preventDefault(),s.stopPropagation(),p("view_sauna_detail",{saunaId:t.id,saunaName:t.name}),a.push(o)},children:["Se badstuen",e.jsx(U,{size:16})]})]})]}),e.jsx("div",{onClick:s=>s.stopPropagation(),children:e.jsx(w,{open:!!g,url:g||"",onClose:()=>f(null),title:`${t.name} booking`})})]})}R.__docgenInfo={description:"",methods:[],displayName:"SaunaCard",props:{sauna:{required:!0,tsType:{name:"SaunaProps"},description:""},isMaintenanceMode:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}}}};export{R as S};
